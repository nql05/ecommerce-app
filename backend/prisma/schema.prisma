generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlserver"
  url      = env("DATABASE_URL")
}

model AddressInfo {
  LoginName          String      @db.VarChar(100)
  AddressID          Int         @default(autoincrement())
  ContactName        String      @db.VarChar(255)
  ContactPhoneNumber String      @db.Char(10)
  City               String      @db.VarChar(100)
  District           String      @db.VarChar(100)
  Commune            String      @db.VarChar(100)
  DetailAddress      String      @db.VarChar(500)
  AddressType        String      @default("Home", map: "DF__AddressIn__Addre__398D8EEE") @db.VarChar(50)
  IsAddressDefault   String      @default("Y", map: "DF__AddressIn__IsAdd__3B75D760") @db.Char(1)
  UserInfo           UserInfo    @relation(fields: [LoginName], references: [LoginName], onDelete: Cascade, map: "FK__AddressIn__Login__3D5E1FD2")
  OrderInfo          OrderInfo[]

  @@id([LoginName, AddressID], map: "PK__AddressI__7B15A65F5E42E0F1")
}

model AppliedVoucher {
  OrderID      Int
  SubOrderID   Int
  VoucherCode  String       @db.VarChar(10)
  Voucher      Voucher      @relation(fields: [VoucherCode], references: [Code], onDelete: Cascade, map: "FK__AppliedVo__Vouch__07C12930")
  SubOrderInfo SubOrderInfo @relation(fields: [OrderID, SubOrderID], references: [OrderID, SubOrderID], onDelete: Cascade, map: "FK__AppliedVoucher__06CD04F7")

  @@id([OrderID, SubOrderID, VoucherCode], map: "PK__AppliedV__476E502A9FB3E67A")
}

model Buyer {
  LoginName  String    @id(map: "PK__Buyer__DB8464FE0E0C4C7F") @db.VarChar(100)
  MoneySpent BigInt    @default(0, map: "DF__Buyer__MoneySpen__2B3F6F97")
  UserInfo   UserInfo  @relation(fields: [LoginName], references: [LoginName], onDelete: Cascade, map: "FK__Buyer__LoginName__2D27B809")
  Comment    Comment[]
}

model Cart {
  CartID    Int         @id(map: "PK__Cart__51BCD797DF71D72A") @default(autoincrement())
  LoginName String      @db.VarChar(100)
  TotalCost BigInt      @default(0, map: "DF__Cart__TotalCost__5629CD9C")
  UserInfo  UserInfo    @relation(fields: [LoginName], references: [LoginName], onDelete: Cascade, map: "FK__Cart__LoginName__571DF1D5")
  StoredSKU StoredSKU[]
}

model Comment {
  CommentID       Int            @id(map: "PK__Comment__C3B4DFAA674B99AD") @default(autoincrement())
  LoginName       String         @db.VarChar(100)
  ProductID       Int?
  SKUName         String?        @db.VarChar(100)
  Ratings         Int?
  Content         String?        @db.VarChar(500)
  ParentCommentID Int?
  SKU             SKU?           @relation(fields: [ProductID, SKUName], references: [ProductID, SKUName], onDelete: Cascade, map: "FK__Comment__73BA3083")
  Buyer           Buyer          @relation(fields: [LoginName], references: [LoginName], onDelete: Cascade, map: "FK__Comment__LoginNa__71D1E811")
  Comment         Comment?       @relation("CommentToComment", fields: [ParentCommentID], references: [CommentID], onDelete: NoAction, onUpdate: NoAction, map: "FK__Comment__ParentC__74AE54BC")
  other_Comment   Comment[]      @relation("CommentToComment")
  CommentImage    CommentImage[]
}

model CommentImage {
  CommentID  Int
  CommentURL String  @db.VarChar(200)
  Comment    Comment @relation(fields: [CommentID], references: [CommentID], onDelete: Cascade, map: "FK__CommentIm__Comme__778AC167")

  @@id([CommentID, CommentURL], map: "PK__CommentI__6B1A7824CCE08CB7")
}

model DeliveryMethod {
  MethodName      String            @id(map: "PK__Delivery__218CFB16C0C9C6E2") @db.VarChar(100)
  ProvideDelivery ProvideDelivery[]
  SubOrderInfo    SubOrderInfo[]
}

model DeliveryPartner {
  LoginName        String           @db.VarChar(100)
  ProviderName     String           @db.VarChar(100)
  UserInfo         UserInfo         @relation(fields: [LoginName], references: [LoginName], onUpdate: NoAction, map: "FK__DeliveryP__Login__123EB7A3")
  DeliveryProvider DeliveryProvider @relation(fields: [ProviderName], references: [ProviderName], onUpdate: NoAction, map: "FK__DeliveryP__Provi__1332DBDC")

  @@id([LoginName, ProviderName], map: "PK__Delivery__8C543330878BEC3E")
}

model DeliveryProvider {
  ProviderName    String            @id(map: "PK__Delivery__7D057CE49DB05FF9") @db.VarChar(100)
  DeliveryPartner DeliveryPartner[]
  ProvideDelivery ProvideDelivery[]
  SubOrderInfo    SubOrderInfo[]
}

model FlatDiscountVoucher {
  Code           String @id(map: "PK__FlatDisc__A25C5AA6E72AB6FA") @db.VarChar(10)
  DiscountAmount Int    @default(0, map: "DF__FlatDisco__Disco__0F624AF8")
}

model OrderInfo {
  OrderID          Int            @id(map: "PK__OrderInf__C3905BAFF7F61026") @default(autoincrement())
  LoginName        String         @db.VarChar(100)
  OrderDate        DateTime       @default(now(), map: "DF__OrderInfo__Order__403A8C7D")
  TotalPrice       BigInt         @default(0, map: "DF__OrderInfo__Total__412EB0B6")
  BankProviderName String         @default("VCB", map: "DF__OrderInfo__BankP__4316F928") @db.VarChar(10)
  AccountID        String?        @db.VarChar(30)
  AddressID        Int
  AddressInfo      AddressInfo    @relation(fields: [LoginName, AddressID], references: [LoginName, AddressID], onDelete: Cascade, map: "FK__OrderInfo__45F365D3")
  SubOrderInfo     SubOrderInfo[]
}

model PercentageVoucher {
  Code               String  @id(map: "PK__Percenta__A25C5AA6090D850B") @db.VarChar(10)
  PercentageDiscount Decimal @default(0.0, map: "DF__Percentag__Perce__0A9D95DB") @db.Decimal(10, 2)
  MaxAmountAllowed   Int     @default(1, map: "DF__Percentag__MaxAm__0B91BA14")
  Voucher            Voucher @relation(fields: [Code], references: [Code], onDelete: Cascade, map: "FK__Percentage__Code__0C85DE4D")
}

model ProductInfo {
  ProductID          Int            @id(map: "PK__ProductI__B40CC6EDC30BE6FA") @default(autoincrement())
  LoginName          String         @db.VarChar(100)
  ProductName        String         @db.VarChar(100)
  ProductBrand       String?        @db.VarChar(100)
  ProductCategory    String         @db.VarChar(100)
  ProductDescription String?        @db.VarChar(500)
  ProductMadeIn      String         @db.VarChar(100)
  Seller             Seller         @relation(fields: [LoginName], references: [LoginName], onDelete: Cascade, map: "FK__ProductIn__Login__5DCAEF64")
  SKU                SKU[]
  VoucherOffer       VoucherOffer[]
}

model ProvideDelivery {
  ProviderName     String           @db.VarChar(100)
  MethodName       String           @db.VarChar(100)
  DeliveryMethod   DeliveryMethod   @relation(fields: [MethodName], references: [MethodName], onDelete: Cascade, map: "FK__ProvideDe__Metho__5AEE82B9")
  DeliveryProvider DeliveryProvider @relation(fields: [ProviderName], references: [ProviderName], onDelete: Cascade, map: "FK__ProvideDe__Provi__59FA5E80")

  @@id([ProviderName, MethodName], map: "PK__ProvideD__0F1DB355FA7A4E8F")
}

model Seller {
  LoginName     String        @id(map: "PK__Seller__DB8464FEC936FC22") @db.VarChar(100)
  ShopName      String        @unique(map: "UQ__Seller__649A7D9623794B3B") @db.VarChar(100)
  CitizenIDCard String        @unique(map: "UQ__Seller__029D5F14C21320DC") @db.VarChar(30)
  SellerName    String        @unique(map: "UQ__Seller__030470FA9B4B17A3") @db.VarChar(50)
  MoneyEarned   BigInt        @default(0, map: "DF__Seller__MoneyEar__33D4B598")
  ProductInfo   ProductInfo[]
  UserInfo      UserInfo      @relation(fields: [LoginName], references: [LoginName], onDelete: Cascade, map: "FK__Seller__LoginNam__35BCFE0A")
}

model SKU {
  ProductID      Int
  SKUName        String           @db.VarChar(100)
  Size           Int?
  Price          Int
  InStockNumber  Int              @default(0, map: "DF__SKU__InStockNumb__60A75C0F")
  Weight         Int?
  Comment        Comment[]
  ProductInfo    ProductInfo      @relation(fields: [ProductID], references: [ProductID], onUpdate: NoAction, map: "FK__SKU__ProductID__619B8048")
  SKUImage       SKUImage[]
  StoredSKU      StoredSKU[]
  SubOrderDetail SubOrderDetail[]

  @@id([ProductID, SKUName], map: "PK__SKU__5C8C537BCB2C50FE")
}

model SKUImage {
  ProductID Int
  SKUName   String @db.VarChar(100)
  SKU_URL   String @db.VarChar(200)
  SKU       SKU    @relation(fields: [ProductID, SKUName], references: [ProductID, SKUName], onDelete: Cascade, map: "FK__SKUImage__6E01572D")

  @@id([ProductID, SKUName, SKU_URL], map: "PK__SKUImage__9389F47B35643339")
}

model StoredSKU {
  CartID    Int
  ProductID Int
  SKUName   String @db.VarChar(100)
  Quantity  Int    @default(0, map: "DF__StoredSKU__Quant__6477ECF3")
  SKU       SKU    @relation(fields: [ProductID, SKUName], references: [ProductID, SKUName], onDelete: Cascade, map: "FK__StoredSKU__66603565")
  Cart      Cart   @relation(fields: [CartID], references: [CartID], onDelete: Cascade, map: "FK__StoredSKU__CartI__656C112C")

  @@id([ProductID, CartID, SKUName], map: "PK__StoredSK__BF9F02CD9EF83931")
}

model SubOrderDetail {
  OrderID      Int
  SubOrderID   Int
  ProductID    Int
  SKUName      String       @db.VarChar(100)
  Quantity     Int          @default(0, map: "DF__SubOrderD__Quant__693CA210")
  SubOrderInfo SubOrderInfo @relation(fields: [OrderID, SubOrderID], references: [OrderID, SubOrderID], onDelete: Cascade, map: "FK__SubOrderDetail__6A30C649")
  SKU          SKU          @relation(fields: [ProductID, SKUName], references: [ProductID, SKUName], onDelete: Cascade, map: "FK__SubOrderDetail__6B24EA82")

  @@id([SubOrderID, SKUName], map: "PK__SubOrder__30908605636D8562")
}

model SubOrderInfo {
  OrderID              Int
  SubOrderID           Int              @default(autoincrement())
  TotalSKUPrice        BigInt           @default(0, map: "DF__SubOrderI__Total__48CFD27E")
  ShippingStatus       String           @default("Preparing", map: "DF__SubOrderI__Shipp__49C3F6B7") @db.VarChar(20)
  ActualDate           DateTime
  ExpectedDate         DateTime
  DeliveryMethodName   String           @db.VarChar(100)
  DeliveryProviderName String           @db.VarChar(100)
  DeliveryPrice        Int              @default(0, map: "DF__SubOrderI__Deliv__4BAC3F29")
  AppliedVoucher       AppliedVoucher[]
  SubOrderDetail       SubOrderDetail[]
  DeliveryMethod       DeliveryMethod   @relation(fields: [DeliveryMethodName], references: [MethodName], onDelete: Cascade, map: "FK__SubOrderI__Deliv__52593CB8")
  DeliveryProvider     DeliveryProvider @relation(fields: [DeliveryProviderName], references: [ProviderName], onDelete: Cascade, map: "FK__SubOrderI__Deliv__534D60F1")
  OrderInfo            OrderInfo        @relation(fields: [OrderID], references: [OrderID], onDelete: Cascade, map: "FK__SubOrderI__Order__4CA06362")

  @@id([OrderID, SubOrderID], map: "PK__SubOrder__EE115A964250E10B")
}

model UserInfo {
  LoginName       String            @id(map: "PK__UserInfo__DB8464FE8D3B1EF8") @db.VarChar(100)
  Password        String            @db.VarChar(255)
  PhoneNumber     String?           @db.Char(10)
  Email           String?           @db.VarChar(255)
  UserName        String            @unique(map: "UQ__UserInfo__C9F2845614722D36") @db.VarChar(255)
  Gender          String?           @db.Char(1)
  BirthDate       DateTime?         @db.Date
  Age             Int?
  Address         String?           @db.VarChar(500)
  AddressInfo     AddressInfo[]
  Buyer           Buyer?
  Cart            Cart[]
  DeliveryPartner DeliveryPartner[]
  Seller          Seller?
  VoucherOffer    VoucherOffer[]
  Withdrawal      Withdrawal[]
}

model Voucher {
  VoucherID         Int                @unique(map: "UQ__Voucher__3AEE79C05EC34BC5") @default(autoincrement())
  Code              String             @id(map: "PK__Voucher__A25C5AA6816BF31F") @db.VarChar(10)
  StartedTime       DateTime
  ExpiredTime       DateTime
  CurrentUsedNumber Int                @default(0, map: "DF__Voucher__Current__7B5B524B")
  MaxUsedNumber     Int                @default(1, map: "DF__Voucher__MaxUsed__7C4F7684")
  MinMoneyValue     Int                @default(0, map: "DF__Voucher__MinMone__7D439ABD")
  AppliedVoucher    AppliedVoucher[]
  PercentageVoucher PercentageVoucher?
  VoucherOffer      VoucherOffer[]
}

model VoucherOffer {
  VoucherCode String      @db.VarChar(10)
  ProductID   Int
  LoginName   String      @db.VarChar(100)
  UserInfo    UserInfo    @relation(fields: [LoginName], references: [LoginName], onUpdate: NoAction, map: "FK__VoucherOf__Login__03F0984C")
  ProductInfo ProductInfo @relation(fields: [ProductID], references: [ProductID], onUpdate: NoAction, map: "FK__VoucherOf__Produ__02FC7413")
  Voucher     Voucher     @relation(fields: [VoucherCode], references: [Code], onDelete: Cascade, map: "FK__VoucherOf__Vouch__02084FDA")

  @@id([VoucherCode, ProductID], map: "PK__VoucherO__B44A70C6785F37E0")
}

model Withdrawal {
  WithdrawalID     Int      @id(map: "PK__Withdraw__7C842C4E6E8A330D") @default(autoincrement())
  LoginName        String   @db.VarChar(100)
  WithdrawalAmount Int
  WithdrawalTime   DateTime
  AccountID        String?  @unique(map: "UQ__Withdraw__349DA587E115ADBA") @db.VarChar(30)
  ProviderName     String   @default("VCB", map: "DF__Withdrawa__Provi__17F790F9") @db.VarChar(100)
  RemainingBalance Int      @default(0, map: "DF__Withdrawa__Remai__19DFD96B")
  UserInfo         UserInfo @relation(fields: [LoginName], references: [LoginName], onDelete: Cascade, map: "FK__Withdrawa__Login__17036CC0")
}
